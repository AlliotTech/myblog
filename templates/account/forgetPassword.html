{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
    <title>重置密码</title>
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}"/>
    <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}">
    <link rel="stylesheet" href="{% static 'css/forgetPassword.css' %}">
    <script src="{% static 'jquery-3.5.1/jquery-3.5.1.min.js' %}"></script>
    <script src="{% static 'jquery.easing/jquery.easing.min.js' %}"></script>
</head>
<body>
<div class="main">
    <!-- multistep form -->
    <form id="msform" action="{% url 'account:loginRegister' %}" method="post">
        <!-- progressbar -->
        <ul id="progressbar">
            <li class="active">身份验证</li>
            <li>设置新密码</li>
            <li>重置完成</li>
        </ul>
        <!-- fieldsets -->
        <fieldset>
            <h2 class="fs-title">身份验证</h2>
            <div class="form-group">
                <input type="email" name="logemail" class="form-style" placeholder="邮箱"
                       autocomplete="off" required
                       oninvalid="setCustomValidity('请输入邮箱号');"
                       oninput="setCustomValidity('');">
                <i class="input-icon layui-icon layui-icon-email"></i>
            </div>
            <div class="form-group mt-2 verification">
                <input type="password" name="logpass" class="form-style"
                       placeholder="验证码" autocomplete="off" required
                       oninvalid="setCustomValidity('请输入验证码');"
                       oninput="setCustomValidity('');">
                <i class="input-icon layui-icon layui-icon-vercode"></i>
                <button type="button" class="layui-btn layui-btn-primary auth-btn">获取验证码</button>
            </div>
            <input type="button" name="next" class="next action-button" value="下一步"/>
        </fieldset>
        <fieldset>
            <h2 class="fs-title">设置新密码</h2>
            <div class="form-group mt-2">
                <input type="password" name="pwd-1" lay-verify="required"
                       lay-vertype="tips" class="form-style" placeholder="新密码"
                       autocomplete="off" required="required"
                       pattern="^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$"
                       oninvalid="setCustomValidity('密码为6到16位包含字母和数字的组合');"
                       oninput="setCustomValidity('');">
                <i class="input-icon layui-icon layui-icon-password"></i>
            </div>
            <div class="form-group mt-2">
                <input type="password" name="pwd-1" lay-verify="required"
                       lay-vertype="tips" class="form-style" placeholder="确认密码"
                       autocomplete="off" required="required"
                       pattern="^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$"
                       oninvalid="setCustomValidity('密码为6到16位包含字母和数字的组合');"
                       oninput="setCustomValidity('');">
                <i class="input-icon layui-icon layui-icon-password"></i>
            </div>
            <input type="button" name="previous" class="previous action-button" value="上一步"/>
            <input type="button" name="next" class="next action-button" value="下一步"/>
        </fieldset>
        <fieldset>
            <h2 class="fs-title">重置完成</h2>
            <p>-^0^- 密码重置成功，请重新登录!</p>
            <a href="{% url 'account:loginRegister' %}">
                <input type="submit" name="submit" class="submit action-button" value="登录"/>
            </a>
        </fieldset>
    </form>
</div>
<script>
    $(document).ready(function () {
        //jQuery time
        var current_fs, next_fs, previous_fs; //fieldsets
        var left, opacity, scale; //fieldset properties which we will animate
        var animating; //flag to prevent quick multi-click glitches

        $(".next").click(function () {
            if (animating) return false;
            animating = true;

            current_fs = $(this).parent();
            next_fs = $(this).parent().next();

            //activate next step on progressbar using the index of next_fs
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({opacity: 0}, {
                step: function (now, mx) {
                    //as the opacity of current_fs reduces to 0 - stored in "now"
                    //1. scale current_fs down to 80%
                    scale = 1 - (1 - now) * 0.2;
                    //2. bring next_fs from the right(50%)
                    left = (now * 50) + "%";
                    //3. increase opacity of next_fs to 1 as it moves in
                    opacity = 1 - now;
                    current_fs.css({
                        'transform': 'scale(' + scale + ')',
                        'position': 'absolute',
                        'width': '100%'
                    });
                    next_fs.css({'left': left, 'opacity': opacity});
                },
                duration: 800,
                complete: function () {
                    current_fs.hide();
                    animating = false;
                },
                //this comes from the custom easing plugin
                easing: 'easeInOutBack'
            });
        });

        $(".previous").click(function () {
            if (animating) return false;
            animating = true;

            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();

            //de-activate current step on progressbar
            $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

            //show the previous fieldset
            previous_fs.show();
            //hide the current fieldset with style
            current_fs.animate({opacity: 0}, {
                step: function (now, mx) {
                    //as the opacity of current_fs reduces to 0 - stored in "now"
                    //1. scale previous_fs from 80% to 100%
                    scale = 0.8 + (1 - now) * 0.2;
                    //2. take current_fs to the right(50%) - from 0%
                    left = ((1 - now) * 50) + "%";
                    //3. increase opacity of previous_fs to 1 as it moves in
                    opacity = 1 - now;
                    current_fs.css({'left': left});
                    previous_fs.css({'transform': 'scale(' + scale + ')', 'opacity': opacity});
                },
                duration: 800,
                complete: function () {
                    current_fs.hide();
                    animating = false;
                },
                //this comes from the custom easing plugin
                easing: 'easeInOutBack'
            });
        });

        $(".submit").click(function () {
            {#return false;#}
            window.location.href="{% url 'account:loginRegister' %}"
        })
    });
</script>
</body>
</html>