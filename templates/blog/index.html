{% extends 'base-blog.html' %}

{% block title %}Â¥î‰∫ÆÁöÑÂçöÂÆ¢-‰∏ìÊ≥®devopsËá™Âä®ÂåñËøêÁª¥Ôºå‰º†Êí≠‰ºòÁßÄitËøêÁª¥ÊäÄÊúØÊñáÁ´†{% endblock %}

{% block content %}
    <main class="page-main">
        <div class="layui-row">
            <div class="layui-col-md-offset2 layui-col-sm12 layui-col-md8 page-main-centre">
                <div class="layui-row main-centre">
                    <!--            ‰∏ª‰ΩìÂ∑¶‰æßÈÉ®ÂàÜ-->
                    <div class="layui-col-md9 main-left">
                        <!--            ËΩÆÊí≠ÂõæÁâá-->
                        <div class="carousel-img layui-carousel" id="test10">
                            <div carousel-item="" class="img-zoom">
                                <div><img lay-src="/media/carousel/carousel-1.jpg"></div>
                                <div><img lay-src="/media/carousel/carousel-2.jpg"></div>
                                <div><img lay-src="/media/carousel/carousel-3.jpg"></div>
                                <div><img lay-src="/media/carousel/carousel-4.jpg"></div>
                                <div><img lay-src="/media/carousel/carousel-5.jpg"></div>
                            </div>
                        </div>
                        <!--            ÊúÄÊñ∞ÊñáÁ´†-->
                        <div class="index-new">
                            <h4>
                                <strong>
                                    <span>üÜï ÊúÄÊñ∞ÊñáÁ´†</span>
                                </strong>
                            </h4>
                            {% for article in articles %}
                                <div class="layui-row layui-col-space20 article-box">
                                    <div class="layui-col-xs12 layui-col-md4">
                                        <div class="img-cover img-zoom">
                                            <a href="/blog/show-{{ article.id }}" title="{{ article.title }}">
                                                <img lay-src="media/{{ article.img }}" width="100%">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="layui-col-xs12 layui-col-md8">
                                        <h3>
                                            <a href="/blog/show-{{ article.id }}">{{ article.title }}</a>
                                        </h3>
                                        <p class="txt-cont hidden-xs">
                                            <a href="/blog/show-{{ article.id }}">{{ article.excerpt }}</a>
                                        </p>
                                        <div class="list-article-info">
                                            <a href="/blog/category-{{ article.category_id }}"
                                               class="label-tag tag-color-{{ article.category.id }}">{{ article.category }}</a>
                                            <span>
                                                <i class="fas fa-clock">
                                                    <span class="timeago"
                                                          datetime="{{ article.created_time | date:"Y-m-d H:i:s" }}"></span>
                                                </i>
                                            </span>
                                            <span>
                                                <i class="fas fa-eye">{{ article.view }}</i>
                                            </span>
                                            <span>
                                                <i class="fas fa-thumbs-up">{{ article.like }}</i>
                                            </span>
                                            <span>
                                                <i class="fas fa-heart">{{ article.collection }}</i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% include 'blog/aside.html' %}
                    <!--            ‰∏ª‰ΩìÂè≥‰æßÈÉ®ÂàÜ-->
                </div>
            </div>
        </div>
    </main>
{% endblock %}

{% block js %}
    <script>
        <!--ËΩÆÊí≠ÂõæÁâá-->
        $(document).ready(function () {
            w = $(window).width(); //ÊµèËßàÂô®ÂΩìÂâçÁ™óÂè£ÂèØËßÜÂå∫ÂüüÂÆΩÂ∫¶
            if (w > 768) {
                img_height = 400
            } else {
                img_height = 200
            }
        })
        layui.use(['carousel', 'form', 'flow'], function () {
            var carousel = layui.carousel
                , form = layui.form
                , flow = layui.flow;
            //ÂõæÁâáËΩÆÊí≠
            carousel.render({
                elem: '#test10'
                , width: '100%'
                , height: img_height
                , interval: 5000
            });
            //‰∫ã‰ª∂
            carousel.on('change(test4)', function (res) {
                console.log(res)
            });
            var $ = layui.$, active = {
                set: function (othis) {
                    var THIS = 'layui-bg-normal'
                        , key = othis.data('key')
                        , options = {};
                    othis.css('background-color', '#5FB878').siblings().removeAttr('style');
                    options[key] = othis.data('value');
                    ins3.reload(options);
                }
            };
            //ÁõëÂê¨ÂºÄÂÖ≥
            form.on('switch(autoplay)', function () {
                ins3.reload({
                    autoplay: this.checked
                });
            });
            $('.demoSet').on('keyup', function () {
                var value = this.value
                    , options = {};
                if (!/^\d+$/.test(value)) return;

                options[this.name] = value;
                ins3.reload(options);
            });
            // ÊúÄÊñ∞ÊñáÁ´†ÊµÅÂä†ËΩΩ
            flow.load({
                elem: '.index-new' //ÊµÅÂä†ËΩΩÂÆπÂô®
                , done: function (page, next) { //ÊâßË°å‰∏ã‰∏ÄÈ°µÁöÑÂõûË∞É

                    //Ê®°ÊãüÊï∞ÊçÆÊèíÂÖ•
                    setTimeout(function () {
                        console.log(page)
                        var lis = [];
                        $.ajax({
                            type: "GET",
                            url: "{% url 'blog:categoryPage' %}",
                            data: {
                                category_id: 1,
                                limit: 5,
                                page: page
                            },
                            success: function (result) {
                                if (result.code == 1) {
                                    layui.each(result.data, function (index, item) {
                                        var article = ("<div class=\"layui-row layui-col-space20 article-box\">\n" +
                                                    "    <div class=\"layui-col-xs12 layui-col-md4\">\n" +
                                                    "        <div class=\"img-cover img-zoom\">\n" +
                                                    "            <a href=\"/blog/show-"+item.id+"\" title=\"djangoÊµãËØïÈ°µ1\">\n" +
                                                    "                <img width=\"100%\" src=\"media/"+item.img+"\">\n" +
                                                    "            </a>\n" +
                                                    "        </div>\n" +
                                                    "    </div>\n" +
                                                    "    <div class=\"layui-col-xs12 layui-col-md8\">\n" +
                                                    "        <h3>\n" +
                                                    "            <a href=\"/blog/show-"+item.id+"\">"+item.title+"</a>\n" +
                                                    "        </h3>\n" +
                                                    "        <p class=\"txt-cont hidden-xs\">\n" +
                                                    "            <a href=\"/blog/show-"+item.id+"\">"+item.excerpt+"</a>\n" +
                                                    "        </p>\n" +
                                                    "        <div class=\"list-article-info\">\n" +
                                                    "            <a href=\"/blog/category-"+item.category_id+"\" class=\"label-tag tag-color-"+item.category_id+"\">"+item.category+"</a>\n" +
                                                    "            <span>\n" +
                                                    "                    <i class=\"fas fa-clock\">\n" +
                                                    "                        <span>"+item.created_time+"</span>\n" +
                                                    "                    </i>\n" +
                                                    "                </span>\n" +
                                                    "            <span>\n" +
                                                    "                    <i class=\"fas fa-eye\">"+item.view+"</i>\n" +
                                                    "                </span>\n" +
                                                    "            <span>\n" +
                                                    "                    <i class=\"fas fa-thumbs-up\">"+item.like+"</i>\n" +
                                                    "                </span>\n" +
                                                    "            <span>\n" +
                                                    "                    <i class=\"fas fa-heart\">"+item.collection+"</i>\n" +
                                                    "                </span>\n" +
                                                    "        </div>\n" +
                                                    "    </div>\n" +
                                                    "</div>")
                                        lis.push(article)
                                    })
                                } else {
                                    layer.alert(result.msg, {icon: 2});
                                }
                            },
                            error: function (xhr) {
                                alert(xhr.text());
                            }
                        })
                        console.log(lis)
                        //ÊâßË°å‰∏ã‰∏ÄÈ°µÊ∏≤ÊüìÔºåÁ¨¨‰∫åÂèÇÊï∞‰∏∫ÔºöÊª°Ë∂≥‚ÄúÂä†ËΩΩÊõ¥Â§ö‚ÄùÁöÑÊù°‰ª∂ÔºåÂç≥ÂêéÈù¢‰ªçÊúâÂàÜÈ°µ
                        //pages‰∏∫AjaxËøîÂõûÁöÑÊÄªÈ°µÊï∞ÔºåÂè™ÊúâÂΩìÂâçÈ°µÂ∞è‰∫éÊÄªÈ°µÊï∞ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊâç‰ºöÁªßÁª≠Âá∫Áé∞Âä†ËΩΩÊõ¥Â§ö
                        next(lis.join(''), page < 10); //ÂÅáËÆæÊÄªÈ°µÊï∞‰∏∫ 10
                    }, 500);
                }
            })
            ;
        })
        ;
    </script>
    <script>
        // ÂØºËà™Ê†èÂΩìÂâçÊ†áÁ≠æÈ°µ
        $(".nav1").addClass("layui-this");
    </script>
{% endblock %}